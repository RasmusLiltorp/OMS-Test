@page "/OMS/OrderHistory/{orderId}"
@using Microsoft.AspNetCore.Components
@inject NavigationManager Navigation

<PageTitle>Order Details</PageTitle>

<h3>Order Details</h3>

<div class="container mt-4">
    <div class="row">
        <div class="col-md-6">
            <h3>Order Details</h3>

            @if (order != null)
            {
                <div class="card p-3">
                    <p><strong>Order:</strong> @order.OrderId</p>
                    <p><strong>Name:</strong> @order.Name</p>
                    <p><strong>Date:</strong> @order.Date.ToString("dd MMM yyyy")</p>
                    <p><strong>Total Amount:</strong> @order.Amount</p>
                    <button class="btn btn-primary mt-3" @onclick="GoBack">Back to Order History</button>
                </div>
            }
            else
            {
                <p class="text-danger">Order not found!</p>
            }
        </div>

        <div class="col-md-6">
            <h3>Products in Order</h3>

            @if (order != null && order.Products.Any())
            {
                <div class="card p-3">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Price</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var product in order.Products)
                            {
                                <tr>
                                    <td>@product.Name</td>
                                    <td>@product.Quantity</td>
                                    <td>@product.Price</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
            else
            {
                
                <strong>No products in this order.</strong>
                
            }
        </div>
    </div>
</div>

@code {
    [Parameter] public string orderId { get; set; }

    private Order order;

    // Mockup for orders (temporary)
    private List<Order> orders = new List<Order>
    {
        new Order { OrderId = "1", Name = "Lucas Barlach", Date = new DateTime(2025, 2, 24), Amount = "128,95 kr", Products = new List<Product>
            {
                new Product { Name = "Iphone cover", Price = "99,95 kr", Quantity = 1 },
                new Product { Name = "Iphone tempered glass", Price = "14,5 kr", Quantity = 2}
            } 
        },
        new Order { OrderId = "11", Name = "Rasmus Liltorp", Date = new DateTime(2025, 2, 26), Amount = "1015 kr", Products = new List<Product>() },
        new Order { OrderId = "2", Name = "Casper Holm Bach", Date = new DateTime(2025, 2, 12), Amount = "984,05 kr", Products = new List<Product>() },
        new Order { OrderId = "3", Name = "Christian Olsgaard", Date = new DateTime(2025, 3, 4), Amount = "458,5 kr", Products = new List<Product>() },
        new Order { OrderId = "4", Name = "Julius Konge", Date = new DateTime(2025, 1, 2), Amount = "14,5 kr", Products = new List<Product>() },
        new Order { OrderId = "1111", Name = "Sofus Barlach", Date = new DateTime(2025, 2, 24), Amount = "128,95 kr", Products = new List<Product>() }
    };

    protected override void OnInitialized()
    {
        order = orders.FirstOrDefault(o => o.OrderId == orderId);
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/OMS/OrderHistory");
    }

    public class Order
    {
        public string OrderId { get; set; }
        public string Name { get; set; }
        public DateTime Date { get; set; }
        public string Amount { get; set; }

        public List<Product> Products { get; set; }
    }

    public class Product
    {
        public string Name { get; set; } = string.Empty;
        public string Price { get; set; }
        public int Quantity { get; set; }
    }
}
